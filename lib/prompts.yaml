_common:
  base_system: &BASE_SYS |
    너는 시나리오 구조 전문가이자 한글 글쓰기 보조자다.
    아래 조건을 반드시 만족하며 출력을 생성하라.

    [서사 규칙]
    1. 주인공은 1막에서는 결핍/고집/두려움을 지닌 상태이며, 3막 결말에서는 행동과 태도의 변화가 명확해야 한다.
    2. 모든 비트는 감정이 아니라 '행동' 중심으로 서술한다. (예: "화가 난다" ❌ → "컵을 내리치며 말을 끊는다" ✅)
    3. 추상어·상투적 표현 금지. 구체적 명사·동사 중심. (예: "갈등이 생긴다" ❌ → "회사 계좌에서 3억이 사라지고, 대표 민수는 혜진을 의심한다" ✅)
    4. 도덕적으로 흑백이 아닌 회색 결말. '누가 옳다'가 아니라 '각자가 이유가 있다'.
    5. 반드시 내적 갈등 + 외적 갈등이 동시에 존재해야 한다.
    6. 2막 전환점 이후, 주인공의 목표가 변경되거나 뒤집혀야 한다. (겉 목표 → 진짜 목표)
    7. 모든 내용은 씬처럼 묘사할 것. 사건 없이 감정 서술만 하는 문장은 금지.

    [문장 규칙]
    - 모든 문장은 주어+동사 형태의 '완결된 행동 문장'으로 작성.
    - "한다/했다" 체 고정. 수필식, 산문식 금지.

    [JSON 출력 규칙]
    - 오직 JSON만 출력.
    - Key/Value는 모두 따옴표 포함.
    - 주석, 설명문, 메타 발화 금지.
    - JSON 파싱 오류 유발 문장 금지 (trailing comma 포함 금지).

    [품질 자동 점검]
    - "주인공의 변화"가 드러나는가?
    - "도덕적 회색지대"가 있는가?
    - "동작 기반 구체적 묘사"인가?
    - "각 비트가 사건 단위로 명확한가?"

create_logline:
  system: |
    너는 웹소설을 쓰기 위한 매력적인 로그라인을 만들어 내는 전문가야.
  user: |
    다음 조건을 만족하는 웹소설 로그라인을 만들어줘.

    [형식]
    "A(주인공)이 B(목표)를 위해 C(행동)하는 이야기"
    예를 들어, "평생 완벽한 피부를 유지할 수 있는 세상에서 노인의학과 의사인 주인공이 자신의 직업적 신념을 지키기 위해 그 시술을 거부하는 이야기"

    [조건]
    1. {genre}의 이야기를 만들어 줘.
    2. A(주인공)의 상황이 뚜렷해야 해. 세계관이 여기에 포함되어야 해.
    3. B(목표)가 명확해야 해. 그리고 이 주인공의 목표는 반드시 어떤 장애에 부딪혀야 해.
    4. C(행동)은 주인공이 B를 이루기 위해, 그 과정에 있는 장애물을 극복하기 위한 행동이어야 해.

create_from_logline_w_gulino:
  system: *BASE_SYS
  user: |
    다음 로그라인을 3막 8시퀀스 구조(폴 조셉 줄리노)에 맞춰
    각 비트를 3문장 이하로 생성하세요.
    비트 이름은 아래 한글 명칭을 그대로 쓰고, 각 항목은 해당 막(1막/2막/3막)에 넣어라.
    JSON 스키마는 아래 "출력 형식"을 따르라.

    [로그라인]
    {logline}

    [비트 이름(막 별 배열 순서 고정)]
    1막
    - 설정: 누구, 무엇, 어디, 그리고 무슨 상황에서 극이 진행될 것인가 등의 의문들에 대한 답 제공.
    - 문제 발생: 주요 긴장 축(적대자, 곤경)의 설정과 극적 의문 정리. 주요 갈등 설정.

    2막
    - 첫 시도와 작은 성공: 1막의 끝에서 제기된 문제 해결을 위한 첫 시도. 제일 쉬운 해결책 제시. 
    - 실패와 상황 반전: 첫 시도가 실패했음이 밝혀지고, 추가 조치가 취해짐. 새롭게 발생한 복잡한 상황들을 해결하기 위해 노력. 관객은 이 시점에서 종종 극적 의문의 답에 대한 매우 명확한 느낌을 받음.
    - 새로운 변수 등장: 새롭게 발생한 복잡한 상황들을 해결하기 위한 노력. 새 캐릭터들과 새 기획이 등장.
    - 위기 심화: 긴장 해소를 위해 사용되었던 손쉬워 보였던 해답들이 모두 사라짐. 최악의 상황에서 주인공이 해결을 위해 노력.

    3막
    - 최종 돌파 시도: 위기감과 진행 속도가 높아짐. 대부분 뜻밖의 전개가 보임.
    - 결말/해소: 개시점에서 발생했던 불균형이 긍정적으로든 부정적으로든 해소. 에필로그 혹은 피날레 포함.

    [출력 형식]
    {{
      "metadata": {{
        "framework": "폴 조셉 줄리노 3막 8시퀀스",
        "logline": "{logline}",
        "lang": "ko"
      }},
      "막": {{
        "1막": [
          {{"이름":"설정","내용":"..."}},
          {{"이름":"문제 발생","내용":"..."}}
        ],
        "2막": [
          {{"이름":"첫 시도와 작은 성공","내용":"..."}},
          {{"이름":"실패와 상황 반전","내용":"..."}},
          {{"이름":"새로운 변수 등장","내용":"..."}},
          {{"이름":"위기 심화","내용":"..."}}
        ],
        "3막": [
          {{"이름":"최종 돌파 시도","내용":"..."}},
          {{"이름":"결말/해소","내용":"..."}}
        ]
      }}
    }}

create_from_logline_w_vogel:
  system: *BASE_SYS
  user: |
    다음 로그라인을 영웅의 여정(크리스토퍼 보글러) 12단계에 맞춰
    각 비트는 3문장 이하로 생성하라.
    비트 이름은 아래 한글 명칭을 그대로 쓰고, 각 항목은 해당 막에 넣어라.
    JSON 스키마는 아래 "출력 형식"을 따르라.

    [로그라인]
    {logline}

    [비트 이름(막 별 배열 순서 고정)]
    1막
    - 일상 세계: 이야기의 시작을 위한 소재 제시. 일상 세계의 평범함을 통해 모험이 진행될 세계의 차별성 부각.
    - 모험의 부름: 일상을 떠나 특별한 세계로 떠나야 함을 암시. 이야기의 시발점으로 작동.
    - 부름의 거부: 소명을 받아들일지 고민. 두려움 때문에 소명을 거부, 극적 긴장감 고조.
    - 조력자와의 만남: 조력자 만남. 모험에 필요한 것들을 제공하고 모험을 지속하도록 격려.
    - 첫 문턱 통과: 특별한 세계에 들어서며 첫 관문 통과. 관문 수호자를 만남.

    2막
    - 시험/동료/적: 시련을 이겨 내고 영웅으로 거듭나는 세 요소를 경험.
    - 가장 깊은 동굴로의 접근: 여정의 핵심인 동굴에 도달. 협력자의 도움을 통해 난관을 해결해 감.
    - 시련: 영웅은 최강의 적을 마주함. 시련을 겪으며 죽음을 경험, 다시 태어나는 과정을 거침.
    - 보상: 시련을 이겨 낸 영웅은 검, 보물, 영약 등을 보상으로 받음.

    3막
    - 귀환의 길: 보상을 가지고 일상으로 돌아갈지, 모험을 지속할지 선택의 기로에 섬.
    - 부활: 집으로 귀환. 최후의 시련을 경험하고 부활을 경험.
    - 영약을 가지고 귀환: 불로불사의 영약을 가지고 귀환하여 여정의 막을 내림.

    [출력 형식]
    {{
      "metadata": {{
        "framework": "크리스토퍼 보글러 영웅의 여정",
        "logline": "{logline}",
        "lang": "ko"
      }},
      "막": {{
        "1막": [
          {{"이름":"일상 세계","내용":"..."}},
          {{"이름":"모험의 부름","내용":"..."}},
          {{"이름":"부름의 거부","내용":"..."}},
          {{"이름":"조력자와의 만남","내용":"..."}},
          {{"이름":"첫 문턱 통과","내용":"..."}}
        ],
        "2막": [
          {{"이름":"시험/동료/적","내용":"..."}},
          {{"이름":"가장 깊은 동굴로의 접근","내용":"..."}},
          {{"이름":"시련","내용":"..."}},
          {{"이름":"보상","내용":"..."}}
        ],
        "3막": [
          {{"이름":"귀환의 길","내용":"..."}},
          {{"이름":"부활","내용":"..."}},
          {{"이름":"영약을 가지고 귀환","내용":"..."}}
        ]
      }}
    }}

create_from_logline_w_snider:
  system: *BASE_SYS
  user: |
    다음 로그라인을 블레이크 스나이더 15장 구조에 맞춰
    각 비트를 3문장 이하로 생성하세요.
    비트 이름은 아래 한글 명칭을 그대로 쓰고, 각 항목은 해당 막에 넣어라.
    JSON 스키마는 아래 "출력 형식"을 따르라.

    [로그라인]
    {logline}

    [비트 이름(막 별 배열 순서 고정)]
    1막
    - 오프닝 이미지: 작품의 분위기, 유형, 단서. '마지막 이미지'와 대척점이 되는, '이전'에 해당하는 스냅 샷.
    - 주제 제시: 주제를 함축적으로 드러냄. 대체로 주인공이 어떤 말을 듣는 장면으로 나타남. 주인공은 나중에 가서야 그 말의 참뜻을 이해함.
    - 설정: 모험이 시작되기 전의 세계. 모든 인물을 소개하거나 암시.
    - 촉발 사건: 작품에서 처음으로 발생하는 중대한 사건. 모든 인물을 소개하거나 암시.
    - 토론: 이 여정을 떠나야 할지 말아야 할지 갈등하는 주인공의 모습. 한 컷일 수도, 여러 컷일 수도. 생략되어 있을 수도 있음.

    2막
    - 2막 진입: 주인공의 결단, 여정의 시작. 주인공은 스스로가 내린 결정에 의해 2막에 들어서야 함.
    - B스토리: 분위기 전환. 러브 스토리, 가족 이야기 등의 감정적인 장면에 할애되는 경우가 많음. 주제에 대한 토론을 포함하면 좋음.
    - 즐거움과 게임: 작품 최대의 재미를 추구. 독자가 플롯을 잊고 (스토리 외적으로) 작품의 셀링 포인트를 즐기게 됨. 작가가 특기를 마음껏 어필함.
    - 중간점: 작품의 전반부와 후반부를 가름. 주인공이 상승의 정점을 찍거나 (가짜 승리) 주변의 세계과 붕괴하기 시작함.
    - 악당의 압박: 중간점까지의 흐름을 역행. 내부적으로나(주인공에게 내재된 문제) 외부적으로나(실재하는 적) 치명적 위험이 닥침.

    3막
    - 절망의 순간: 주인공의 (가짜) 패배. 주인공에게 소중한 무엇인가의 죽음.
    - 영혼의 어두운 밤: 모든 희망을 잃은 주인공의 모습.
    - 3막 진입: 해답 발견, 결론 도출. 새로운 영감, 막판의 행동, B스토리에서 감정선을 이끌어 가던 인물 등이 계기가 되어서 새로운 해답이 도출됨.
    - 결말(피날레): 두 세계의 종합, 새로운 세계. 이전 세계와 새로이 배운 세계를 토대로 제3의 길로 나아가는 주인공.
    - 마지막 이미지: 변화가 일어났음을 증명. '오프닝 이미지'의 대척점. 모든 이야기는 '변화'에 대한 것이므로 그 변화는 극적이어야 함.

    [출력 형식]
    {{
      "metadata": {{
        "framework": "블레이크 스나이더 15장",
        "logline": "{logline}",
        "lang": "ko"
      }},
      "막": {{
        "1막": [
          {{"이름":"오프닝 이미지","내용":"..."}},
          {{"이름":"주제 제시","내용":"..."}},
          {{"이름":"설정","내용":"..."}},
          {{"이름":"촉발 사건","내용":"..."}},
          {{"이름":"토론","내용":"..."}}
        ],
        "2막": [
          {{"이름":"2막 진입","내용":"..."}},
          {{"이름":"B스토리","내용":"..."}},
          {{"이름":"즐거움과 게임","내용":"..."}},
          {{"이름":"중간점","내용":"..."}},
          {{"이름":"악당의 압박","내용":"..."}}
        ],
        "3막": [
          {{"이름":"절망의 순간","내용":"..."}},
          {{"이름":"영혼의 어두운 밤","내용":"..."}},
          {{"이름":"3막 진입","내용":"..."}},
          {{"이름":"결말(피날레)","내용":"..."}},
          {{"이름":"마지막 이미지","내용":"..."}}
        ]
      }}
    }}

extract_structure:
  system: |
    당신은 3막 구조 분석에 특화된 스토리 분석가입니다.
    당신의 임무는 주어진 이야기에서 처음, 중간, 끝의 세 요소를 추출하는 것입니다.
    처음, 중간, 끝의 세 요소의 특징은 다음과 같습니다.

    1. 처음: 평온한 삶을 살던 주인공이 어떤 사건을 만나 이야기를 끌고 나가는 목표를 가지게 되는 순간.
    2. 중간: 그 목표를 이루기 위해 대결하던 주인공이 대결을 통해 원래의 목표가 아닌 새로운 목표, 진정한 목표를 가지게 되는 전환점.
    3. 끝: 중간점에서 획득한 진정한 목표를 추구하던 주인공이 성공/실패하면서 처음과는 다른 성격을 가지게 됨
  user: |
    아래 이야기를 분석해서 JSON 형식으로 출력하세요.

    [이야기]
    {story}

    [출력 형식]
    {{
      "처음": "...",
      "중간": "...",
      "끝": "..."
    }}


extract_plot_point:
  system: |
    당신은 3막 구조 분석에 특화된 스토리 분석가입니다.
    당신의 임무는 입력된 이야기를 바탕으로 다음 세 가지 요소를 추출하는 것입니다:
    1. 전환점 (Act 2의 핵심 변화 지점)
    2. 주인공의 성격 변화
    3. 주제 (이야기가 던지는 질문 또는 메시지)
    
    반드시 아래 JSON 형식을 그대로 따르십시오.
    한글로 작성하며, 설명 이외의 불필요한 문장은 포함하지 마십시오.
    출력 외 텍스트는 절대 추가하지 마십시오.
  user: |
    아래 이야기를 분석하여 JSON 형식으로 출력하십시오.

    [필수 분석 요소]

    1. 전환점:
       - 주인공의 **겉목표(표면적 목표)**가 **진정한 목표(내적 목표)**로 바뀌는 순간을 서술하십시오.
       - 전환점이 **어떤 사건으로 인해** 발생했는지, 그리고 **주인공의 목표가 어떻게 재정의되었는지**를 포함하십시오.

    2. 주인공의 성격 변화:
       - 1막(초기 상태) → 2막의 전환점 → 3막 결말까지,
         주인공이 **어떤 내적 변화를 겪었는지**를 인과적으로 설명하십시오.
       - 단순한 감정 변화가 아니라 **가치관/태도/신념의 변화**를 기술하십시오.

    3. 주제:
       - 전환점과 성격 변화를 관통하는 **이야기의 근본 질문 또는 메시지**를 1문장으로 요약하십시오.
       - '교훈'이 아니라 **서사가 던지는 문제의식**이어야 합니다.
    
    [이야기]
    {story}

    [출력 형식]
    {{
      "전환점": "...",
      "주인공 성격 변화": "...",
      "주제": "..."
    }}
create_from_logline:
  system: *BASE_SYS
  user: |
    다음 로그라인을 3막 8시퀀스 구조에 맞춰
    비트 이름은 아래 한글 명칭을 그대로 쓰고, 각 항목은 해당 막(1막/2막/3막)에 넣어라.
    각 비트의 길이는 상관 없고 비트의 기능을 충분히 하기 위해서 길게 써야 한다면 충분히 길게 써 줘.
    다 똑같이 3줄로 하면 어디가 중요하고 어디가 중요하지 않은지 안 보이니까, 힘을 줘야 하는 부분은 더 길게 작성해 줘.
    각 비트는 내부에 3장 구조, 그러니까 시작-중간-끝 구조를 포함하도록 작성해 줘.
    JSON 스키마는 아래 "출력 형식"을 따르라.
    각 막과 비트에 대한 설명은 다음과 같다'.

    [막 및 비트 설명]
    1막 (Act I)
    시퀀스 1. 설정과 문제 제기
    * 세계관 소개, 주인공의 현재 상태 제시
    * 주인공이 가진 결핍 혹은 욕망 드러남
    * 관객이 “이 이야기는 무엇에 관한가?”를 이해하게 됨
    * 보통 **Inciting Incident(발단 사건)**가 이 안 혹은 끝무렵에 등장
    핵심 기능:주인공의 일상 ⟶ 사건 발생 ⟶ 균열 발생

    시퀀스 2. 주인공의 갈등/의사결정 → 1막 클라이맥스
    * 주인공은 발단 사건에 대응하려 하지만 아직 완전한 행동 변화는 아님
    * 선택을 미루거나, 문제를 이해하려고 하거나, 대응하려다가 실패하는 파트
    * 시퀀스 마지막에서 주인공은 결정적인 선택을 한다→ 이야기의 주된 방향이 확정되고 2막으로 진입
    핵심 기능:“이 길로 간다”는 주인공의 본격적 출발(Act I Break)

    2막 (Act II 긴장 상승의 영역)
    시퀀스 3. 첫 번째 시도/새 세계 적응
    * 새 세계, 새 규칙 등장
    * 주인공의 첫 시도는 미숙하거나 부분적 성공
    * 조력자 또는 새로운 인물 등장 가능
    * 목표는 명확하지만 전략이 아직 미완성
    핵심 기능:2막의 기본 게임 규칙을 관객에게 각인

    시퀀스 4. 중간 실패 → 1차 전환점(Midpoint 직전 상승)
    * 장애가 커지고 갈등이 심화됨
    * 주인공의 전략이 점점 성공하기도 하지만 더 큰 위기를 준비하는 단계
    * 시퀀스 마지막에서 **Midpoint(중심 사건)**이 벌어짐
        * 큰 성공 또는 큰 실패
        * 이야기의 규칙이나 stakes(위험)가 뒤집힘
    핵심 기능:이야기의 허리. 방향이 반전되며 “돌아갈 수 없음”을 확정.

    시퀀스 5. Midpoint 이후의 결과 / 더 어두운 세계
    * 상황이 더 복잡해지고 적의 힘 또는 문제의 본질이 적극적으로 드러남
    * 주인공은 한 번의 큰 치명적 실수를 하거나, 관계가 무너짐
    * 종종 가장 감정적으로 무너지는 대목
    핵심 기능:하강 국면의 시작. 주인공의 결점·두려움이 폭로됨.

    시퀀스 6. “모든 것이 무너지는 순간” → 2막 클라이맥스
    * 이야기에서 가장 큰 패배 혹은 이별/배신이 여기에 위치
    * 주인공은 목표를 거의 잃거나 포기 위기로 몰림
    * 시퀀스 마지막에서 Darkest Moment(암흑의 순간)→ 하지만 3막으로 넘어갈 새로운 결심, ‘내면의 변곡점’이 생김
    핵심 기능:주인공의 변화가 멀리서 윤곽을 드러내기 시작하는 극적 바닥.

    3막 (Act III 해결)
    시퀀스 7. 최종 준비 → 결전 직전까지
    * 주인공이 새 전략, 새 동맹, 진정한 깨달음을 가지고 다시 일어선다
    * 모든 갈등이 최종 결전을 향해 압축
    * 시퀀스의 미니 클라이맥스는 최종 대결의 문을 여는 열쇠
    핵심 기능:“이제 마지막이다”라는 에너지 형성.

    시퀀스 8. 클라이맥스와 결말
    * 이야기가 도달한 문제를 최종적으로 해결
    * 주인공의 성장 혹은 몰락이 완전히 드러남
    * 사건의 여파를 보여주는 결말(denouement)이 뒤따름
    핵심 기능:중심 갈등의 완전한 해결과 서사적 정리.

    [비트 이름(막 별 배열 순서 고정)]
    1막
    - 설정: 누구, 무엇, 어디, 그리고 무슨 상황에서 극이 진행될 것인가 등의 의문들에 대한 답 제공.
    - 문제 발생: 주요 긴장 축(적대자, 곤경)의 설정과 극적 의문 정리. 주요 갈등 설정.

    2막
    - 첫 시도와 작은 성공: 1막의 끝에서 제기된 문제 해결을 위한 첫 시도. 제일 쉬운 해결책 제시. 
    - 실패와 상황 반전: 첫 시도가 실패했음이 밝혀지고, 추가 조치가 취해짐. 새롭게 발생한 복잡한 상황들을 해결하기 위해 노력. 관객은 이 시점에서 종종 극적 의문의 답에 대한 매우 명확한 느낌을 받음.
    - 새로운 변수 등장: 새롭게 발생한 복잡한 상황들을 해결하기 위한 노력. 새 캐릭터들과 새 기획이 등장.
    - 위기 심화: 긴장 해소를 위해 사용되었던 손쉬워 보였던 해답들이 모두 사라짐. 최악의 상황에서 주인공이 해결을 위해 노력.

    3막
    - 최종 돌파 시도: 위기감과 진행 속도가 높아짐. 대부분 뜻밖의 전개가 보임.
    - 결말/해소: 개시점에서 발생했던 불균형이 긍정적으로든 부정적으로든 해소. 에필로그 혹은 피날레 포함.
      
    [로그라인]
    {logline}

    [출력 형식]
    {{
      "metadata": {{
        "framework": "폴 조셉 줄리노 3막 8시퀀스",
        "logline": "{logline}",
        "lang": "ko"
      }},
      "막": {{
        "1막": [
          {{"이름":"설정","내용":"..."}},
          {{"이름":"문제 발생","내용":"..."}}
        ],
        "2막": [
          {{"이름":"첫 시도와 작은 성공","내용":"..."}},
          {{"이름":"실패와 상황 반전","내용":"..."}},
          {{"이름":"새로운 변수 등장","내용":"..."}},
          {{"이름":"위기 심화","내용":"..."}}
        ],
        "3막": [
          {{"이름":"최종 돌파 시도","내용":"..."}},
          {{"이름":"결말/해소","내용":"..."}}
        ]
      }}
    }}